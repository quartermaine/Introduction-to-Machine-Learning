"0","library(kknn)"
"0","s<-spam"
"0","s$Spam<-as.factor(s$Spam)"
"0","n=dim(s)[1]"
"0","set.seed(12345)"
"0","id=sample(1:n, floor(n*0.5))"
"0","strain=s[id,]"
"0","stest=s[-id,]"
"0","#first train the model with train,train and then make predictions"
"0","(knn<-kknn(Spam ~ ., strain,strain, k = 30))"
"1","
Call:
"
"1","kknn(formula = Spam ~ ., train = strain, test = strain, k = 30)"
"1","

"
"1","Response: "
"1","""nominal"""
"1","
"
"0","table(knn$fit,strain$Spam,dnn=c(""Predicted class"",""Real class""))"
"1","               Real class
"
"1","Predicted class"
"1","   0"
"1","   1"
"1","
              0"
"1"," 807"
"1","  98"
"1","
              1"
"1"," 138"
"1"," 327"
"1","
"
"0","e1<-mis_error(knn$fit,strain$Spam)"
"0","(knn1<-kknn(Spam ~ .,strain,stest, k = 30))"
"1","
Call:
"
"1","kknn(formula = Spam ~ ., train = strain, test = stest, k = 30)"
"1","

"
"1","Response: "
"1","""nominal"""
"1","
"
"0","table(knn1$fit,stest$Spam,dnn=c(""Predicted class"",""Real class""))"
"1","               Real class
"
"1","Predicted class"
"1","   0"
"1","   1"
"1","
              0"
"1"," 672"
"1"," 187"
"1","
              1"
"1"," 265"
"1"," 246"
"1","
"
"0","e2<-mis_error(knn1$fit,stest$Spam)"
"0","ac3<-mean(knn$fit==strain$Spam)"
"0","ac4<-mean(knn1$fit==stest$Spam)"
"0","cat(""=====================================\nMissclasification error in train: "", e1,""\nMissclasification error in test:"",e2)"
"1","=====================================
Missclasification error in train: "
"1"," "
"1","0.1722628"
"1"," "
"1","
Missclasification error in test:"
"1"," "
"1","0.329927"
"0","cat(""\n=====================================\nAccuracy in train: "", ac3,""\nAccuracy in test:"",ac4)"
"1","
=====================================
Accuracy in train: "
"1"," "
"1","0.8277372"
"1"," "
"1","
Accuracy in test:"
"1"," "
"1","0.670073"
