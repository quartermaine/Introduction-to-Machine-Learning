"0","n=dim(tecator)[1]"
"0","set.seed(12345)"
"0","id=sample(1:n, floor(n*0.5))"
"0","traindata=tecator[id,]"
"0","validata=tecator[-id,]"
"0","d<- matrix(0, ncol = 2, nrow = 6)"
"0","colnames(d)<-c(""mse_train"",""mse_test"")"
"0","rownames(d)<-c(""poly1"",""poly2"",""poly3"",""poly4"",""poly5"",""poly6"")"
"0","for (i in 1:6){"
"0","  m<-lm(Moisture~poly(Protein,i),data=traindata)"
"0","  preds_valid<-predict(m,validata)"
"0","  preds_train<-predict(m,traindata)"
"0","  "
"0","  mse <- function(true,predicted) {"
"0","    return (mean((true-predicted)^2))"
"0","    }"
"0","  "
"0","  mse_train<-mse(traindata$Moisture,preds_train)"
"0","  mse_test<-mse(validata$Moisture,preds_valid)"
"0","  d[i,1]<-mse_train"
"0","  d[i,2]<-mse_test"
"0","}"
"0","dd<-as.data.frame(d)"
"0","dd$model<-rownames(dd)"
"0","###plot with plotly"
"0","# library(plotly)"
"0","# dd"
"0","# pp <- plot_ly(dd, x = ~model, y = ~mse_train, name = 'mse_train', type = 'scatter',mode=""lines+markers"")%>%"
"0","#   add_trace(x=~model,y = ~mse_test, name ="" mse_test"", mode = 'markers+lines') "
"0","# pp"
"0","###plot with ggplot"
"0","#p1<-ggplot(dd,aes(x=model,y=mse_train,group=1))+geom_point(color=""blue"")+geom_line()"
"0","#p1+geom_point(data=dd, aes(x=model,y=mse_test,color=""red""))+geom_line(data=dd,aes(x=model,y=mse_test))"
"0","pplot<- ggplot(data = dd, aes(x = model,group=1)) +geom_line(aes(y = mse_train,color=""mse_train""))+geom_point(aes(y=mse_train))+geom_line(aes(y=mse_test,color=""mse_test""))+"
"0","  geom_point(aes(y=mse_test))+scale_color_manual(labels = c(""mse_test"", ""mse_train""), values = c(""red"", ""blue""))"
"0","pplot"
