"0","LDA <- function(x, y) {"
"0","  #indexes of 2 classes"
"0","  group1_index <- which( y == ""Male"" )"
"0","  group2_index <- which( y == ""Female"" )"
"0","  #priors probs of classes"
"0","  p1 <- length(group1_index) / length(y)"
"0","  p2 <- length(group2_index) / length(y)"
"0","  prior_probs<-cbind(p1,p2)"
"0","  #means of the classes"
"0","  mean_class1 <- colMeans(x[group1_index, ])"
"0","  mean_class2 <- colMeans(x[group2_index, ])"
"0","  group_centers<-cbind(mean_class1,mean_class2)"
"0","  #subtract the mean of the group from each group"
"0","  x1 = as.matrix(sweep(x[group1_index, ], 2, mean_class1, ""-""))"
"0","  x2 = as.matrix(sweep(x[group2_index, ], 2, mean_class2, ""-""))"
"0","  #covariance matices "
"0","  C1 = cov(x1)     "
"0","  C2 = cov(x2)      "
"0","  #within-class matrix"
"0","  S_w = (C1 + C2 )"
"0","  #means of global means"
"0","  mean_global<-colMeans(x)"
"0","  #between-class matrix "
"0","  S1<-(mean_class1-mean_global)%*%t(mean_class1-mean_global)"
"0","  S2<-(mean_class2-mean_global)%*%t(mean_class2-mean_global)"
"0","  S_b<-length(group1_index)*S1+length(group2_index)*S2"
"0","  #eigen vectors ,slope,intercept of decision equation"
"0","  ev <- eigen(solve(S_w) %*% S_b)$vectors"
"0","  means<-rbind(mean_class2,mean_class1) #rbind means of 2 classes"
"0","  rownames(means)<-c(""Female"",""Male"")"
"0","  gmean<-prior_probs%*%means"
"0","  const <- drop(gmean%*%ev)"
"0","  lda_slope <- - ev[1,1] / ev[2,1]    #slope of decision line"
"0","  lda_intercept <- (const/ev[2,1])[1]  #intercept of decision line"
"0","  "
"0","  #discriminat function of male"
"0","  a0_m<- -0.5*(mean_class1%*%solve(S_w)%*%mean_class1)"
"0","  a1_m<- solve(S_w)%*%mean_class1 "
"0","  a0_f<--0.5*(mean_class2%*%solve(S_w)%*%mean_class2)"
"0","  a1_f<- solve(S_w)%*%mean_class2 "
"0","  "
"0","  a0<-log(p1/p2)-0.5*((mean_class1+mean_class2)%*%solve(S_w)%*%(mean_class2-mean_class1))"
"0","  a1<-t((mean_class2-mean_class1))%*%solve(S_w) #%*%t(as.matrix(x))"
"0","  "
"0","  "
"0","  "
"0","  #make predictions if w*x+C>0-->Male else Female"
"0","  w<-as.matrix(t(solve(S_w)%*%(mean_class1-mean_class2)))%*%t(as.matrix(x))"
"0","  c<-log(p1/p2)-0.5*(mean_class1%*%solve(S_w)%*%mean_class1)+0.5*(mean_class2%*%solve(S_w)%*%mean_class2)"
"0","  preds2<-ifelse(apply(w,2,function(x){x+c})>0,""Male"",""Female"")"
"0","  "
"0","  "
"0","  "
"0","  return(list(""predictions""=preds2,""slope""=lda_slope,""intercept""=lda_intercept,""Group_means""=means,"
"0","              ""discriminant_function_Male""=c(""inter""=a0_m,""coeffs""=a1_m),"
"0","              ""discriminant_function_Female""=c(""inter""=a0_f,""coeffs""=a1_f),"
"0","              ""equation of decision bountary""=c(""inter""=a0,""coeffs""=a1),""C1""=C1))"
"0","  "
"0","}"
