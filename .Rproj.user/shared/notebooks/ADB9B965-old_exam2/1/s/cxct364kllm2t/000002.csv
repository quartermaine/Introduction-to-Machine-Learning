"0","library(boot)"
"0","# "
"0","# rng=function(data,mle) {"
"0","# data1=data.frame(Time=data$Time, Visitors=data$Visitors)"
"0","# n=length(data$Time)"
"0","# #generate new Price"
"0","# data1$Visitors=rnorm(n,predict(mle, newdata=data1,type=""response""),sd(mle$residuals))"
"0","# return(data1)"
"0","# }"
"0","# "
"0","# f1=function(data1){"
"0","# res=glm(Visitors~.,family = poisson(link = ""log""),data=data1) #fit linear model"
"0","# #predict values for all Area values from the original data"
"0","# VisitorsP=predict(res,newdata=bank,type=""response"")"
"0","# n=length(bank$Time)"
"0","# predictedV=rnorm(n,VisitorsP,sd(mle$residuals))"
"0","# return(predictedV)"
"0","# }"
"0","# "
"0","# f2=function(data1){"
"0","# res= glm(Visitors~.,family = poisson(link = ""log""),data=data1)#fit linear model"
"0","# #predict values for all Area values from the original data"
"0","# priceP=predict(res,newdata=bank,type=""response"")"
"0","# return(priceP)"
"0","# }"
"0","# "
"0","# res=boot(bank, statistic=f2, R=1000,mle=poisson_fit,"
"0","#          ran.gen=rng, sim=""parametric"")"
