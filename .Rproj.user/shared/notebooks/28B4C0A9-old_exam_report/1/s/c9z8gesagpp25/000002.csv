"0","##2 layers"
"0","set.seed(1234567890)"
"0","points<-runif(50,0,10)"
"0","dat<-data.frame(points,sin(points))"
"0","train_dat<-dat[1:25,]"
"0","val_dat<-dat[26:50,]"
"0","restrain2 <- double(10)"
"0","resval2 <- double(10)"
"0","# Random initializaiton of the weights in the interval [-1, 1]"
"0","winit1 <- runif(22, -1, 1) "
"0","for(i in 1:10) {"
"0","  nn <- neuralnet(formula = sin.points. ~ points, data = train_dat, "
"0","                  hidden = c(3,3), startweights = winit1,"
"0","                  threshold = i/1000, lifesign = ""none"")"
"0","  "
"0","  # nn$result.matrix"
"0","  # Compute predictions for the trainig set and their mean squared error"
"0","  res3 <- compute(nn, train_dat[,1])$net.result "
"0","  restrain2[i] <- mean((train_dat$sin.points.-res3)^2)"
"0","  # The same for the validation set"
"0","  res4 <- compute(nn, val_dat[,1])$net.result "
"0","  resval2[i] <-mean ((val_dat$sin.points.-res4)^2)"
"0","}"
"0","par(mfrow=c(1,2))"
"0","plot(restrain2, type = ""o"",main=""Error train 2 layers"")"
