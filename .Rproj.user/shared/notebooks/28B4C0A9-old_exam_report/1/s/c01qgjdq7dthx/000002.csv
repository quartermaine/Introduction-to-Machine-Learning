"0","set.seed(1234567890)"
"0","spam <- read.csv2(""spambase.csv"")"
"0","ind <- sample(1:nrow(spam))"
"0","spam <- spam[ind,c(1:48,58)]"
"0","h <- 1"
"0","beta <- 0"
"0","M <- 50"
"0","N <- 500 # number of training points"
"0","gaussian_k <- function(x, h) { # It is fine if students use exp(-x**2)/h instead"
"0","  return (exp(-(x**2)/(2*h*h)))"
"0","}"
"0","SVM <- function(sv,i) { #SVM on point i with support vectors sv"
"0","  yi <- 0"
"0","  for(m in 1:length(sv)) {"
"0","    xixm <- rbind(spam[i,-49],spam[sv[m],-49]) # do not use the true label when computing the distance"
"0","    tm <- 2 * spam[sv[m],49] - 1 # because the true labels must be -1/+1 and spambase has 0/1"
"0","    yi <- yi + tm * gaussian_k(dist(xixm, method=""euclidean""), h)"
"0","  }"
"0","  return (yi)"
"0","}"
"0","errors <- 1"
"0","errorrate <- vector(length = N)"
"0","errorrate[1] <- 1"
"0","sv <- c(1)"
"0","for(i in 2:N) {"
"0","  yi <- SVM(sv,i)"
"0","  ti <- 2 * spam[i,49] - 1"
"0","  "
"0","  if(ti * yi < 0) {"
"0","    errors <- errors + 1"
"0","  }"
"0","  errorrate[i] <- errors/i"
"0","  "
"0","  cat(""."") # iteration "", i, ""error rate "", errorrate[i], ti * yi, ""sv "", length(sv), ""\n"")"
"0","  flush.console()"
"0","  "
"0","  if(ti * yi <= beta) {"
"0","    sv <- c(sv, i)"
"0","    "
"0","    if (length(sv) > M) {"
"0","      for(m in 1:length(sv)) { # remove the support vector that gets classified best without itself"
"0","        sv2 <- sv[-m]"
"0","        ym2 <- SVM(sv2,sv[m])"
"0","        tm <- 2 * spam[sv[m],49] - 1"
"0","        "
"0","        if(m==1) {"
"0","          max <- tm * ym2"
"0","          ind <- 1"
"0","        }"
"0","        else {"
"0","          if(tm * ym2 > max) {"
"0","            max <- tm * ym2"
"0","            ind <- m"
"0","          }"
"0","        }"
"0","      }"
"0","      sv <- sv[-ind]"
"0","      "
"0","      # cat(""removing "", ind, max, ""\n"")"
"0","      # flush.console()"
"0","    }"
"0","  }"
"0","}"
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"1","."
"0","plot(errorrate[seq(from=1, to=N, by=10)], ylim=c(0.2,0.4), type=""o"")"
