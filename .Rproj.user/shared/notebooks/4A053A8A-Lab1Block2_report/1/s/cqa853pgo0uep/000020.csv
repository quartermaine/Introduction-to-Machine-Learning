"0","set.seed(1234567890)"
"0","max_it <- 100 # max number of EM iterations"
"0","min_change <- 0.1 # min change in log likelihood between two consecutive EM iterations"
"0","N=1000 # number of training points"
"0","D=10 # number of dimensions"
"0","x <- matrix(nrow=N, ncol=D) # training data"
"0","# Producing the training data"
"0","for(n in 1:N) {"
"0","  k <- sample(1:3,1,prob=true_pi)"
"0","  for(d in 1:D) {"
"0","    x[n,d] <- rbinom(1,1,true_mu[k,d])"
"0","  }"
"0","}"
"0","K=4 # number of guessed components"
"0","z <- matrix(nrow=N, ncol=K) # fractional component assignments"
"0","pi <- vector(length = K) # mixing coefficients"
"0","mu <- matrix(nrow=K, ncol=D) # conditional distributions"
"0","llik <- vector(length = max_it) # log likelihood of the EM iterations"
"0","# Random initialization of the paramters"
"0","pi <- runif(K,0.49,0.51)"
"0","pi <- pi / sum(pi)"
"0","for(k in 1:K) {"
"0","  mu[k,] <- runif(D,0.49,0.51)"
"0","}"
"0","pi"
"1","[1]"
"1"," 0.2491838"
"1"," 0.2499680"
"1"," 0.2500275"
"1"," 0.2508207"
"1","
"
"0","mu"
"1","    "
"1","      [,1]"
"1","      [,2]"
"1","      [,3]"
"1","      [,4]"
"1","      [,5]"
"1","      [,6]"
"1","      [,7]"
"1","      [,8]"
"1","      [,9]"
"1","     [,10]"
"1","
[1,]"
"1"," 0.4935375"
"1"," 0.5042511"
"1"," 0.5040286"
"1"," 0.4987810"
"1"," 0.5012754"
"1"," 0.4971036"
"1"," 0.4982144"
"1"," 0.4987654"
"1"," 0.4929075"
"1"," 0.4993719"
"1","
[2,]"
"1"," 0.5088453"
"1"," 0.5068730"
"1"," 0.5016720"
"1"," 0.4929275"
"1"," 0.5077146"
"1"," 0.5095075"
"1"," 0.4924574"
"1"," 0.4992470"
"1"," 0.5008651"
"1"," 0.4975302"
"1","
[3,]"
"1"," 0.5077926"
"1"," 0.4939841"
"1"," 0.5059821"
"1"," 0.5063490"
"1"," 0.5041462"
"1"," 0.4929400"
"1"," 0.4992362"
"1"," 0.4943482"
"1"," 0.4903974"
"1"," 0.5089045"
"1","
[4,]"
"1"," 0.4909320"
"1"," 0.4982342"
"1"," 0.4961948"
"1"," 0.4967226"
"1"," 0.4984220"
"1"," 0.4960055"
"1"," 0.4997165"
"1"," 0.5090205"
"1"," 0.5057927"
"1"," 0.4947660"
"1","
"
"0","for(it in 1:max_it) {"
"0","  #plot(mu[1,], type=""o"", col=""blue"", ylim=c(0,1))"
"0","  #points(mu[2,], type=""o"", col=""red"")"
"0","  #points(mu[3,], type=""o"", col=""green"")"
"0","  #points(mu[4,], type=""o"", col=""yellow"")"
"0","  #Sys.sleep(0.5)"
"0","  # E-step: Computation of the fractional component assignments"
"0","  # Your code here"
"0","  m=matrix(nrow=1000,ncol=K)"
"0","  for (i in 1:1000){"
"0","    for (j in 1:K){"
"0","      m[i,j]<-prod((mu[j,]^x[i,])*(1-mu[j,])^(1-x[i,]))"
"0","      "
"0","      #unlist(lapply(mu[j,],function(y){ifelse(x[i,which(y %in% mu[j,])]==1,1-y,y)}))"
"0","    }"
"0","  }"
"0","  m<-t(t(m)*pi)"
"0","  z<-m/rowSums(m)"
"0","   "
"0","  l <- 0"
"0","  for (n in 1:1000) {"
"0","    for (k in 1:K) {"
"0","      sum <- 0"
"0","      for (D in 1:10) {"
"0","        sum =sum+ (x[n, D] * log(mu[k, D]) + (1 - x[n, D]) * log(1 - mu[k, D]))"
"0","      }"
"0","      "
"0","      l = l+ (z[n,k] * (log(pi[k]) + sum))"
"0","    }"
"0","  }"
"0","  "
"0","  llik[it]<-l"
"0","  #cat(""iteration: "", it, ""log likelihood: "", llik[it], ""\n"")"
"0","  #flush.console()"
"0","  # Stop if the lok likelihood has not changed significantly"
"0","  # Your code here"
"0","  if(abs(llik[it]-(llik[it-1]))<=min_change&&(it>1)){"
"0","    "
"0","    break"
"0","  }"
"0","  #M-step: ML parameter estimation from the data and fractional component assignments"
"0","  # Your code here"
"0","  pi<-colSums(z)/N"
"0","  mu<-t(z)%*%x"
"0","  mu<-mu/colSums(z)"
"0","}"
"0","par(mfrow=c(1,2))"
"0","plot(mu[1,], type=""o"", col=""blue"", ylim=c(0,1),main=""Conditional distributions 4K"",xlab = ""iterations"")"
