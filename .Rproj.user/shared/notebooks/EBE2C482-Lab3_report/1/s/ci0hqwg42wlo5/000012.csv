"0","set.seed(1234567890)"
"0","library(geosphere)"
"0","stations <- read.csv(""stations.csv"",stringsAsFactors = F,fileEncoding = ""latin1"")"
"0","temps <- read.csv(""temps50k.csv"",stringsAsFactors = F)"
"0","st <- merge(stations,temps,by=""station_number"")"
"0","h_distance <- 30000        # These three values are up to the students"
"0","h_date <-25"
"0","h_time <-5"
"0","a <- 58.4137 #latitude # The point to predict (up to the students)"
"0","b <- 15.6235  #logitude"
"0","date1 <- ""2013-12-23"" # The date to predict (up to the students)"
"0","times <- c(""04:00:00"", ""06:00:00"",""08:00:00"" ,""10:00:00"",""12:00:00"",""14:00:00"", "
"0","           ""16:00:00"",""18:00:00"",""20:00:00"",""22:00:00"",""24:00:00"")"
"0","temp <- vector(length=length(times))"
"0","# Studentsâ€™ code here"
"0","timesf<-as.POSIXct(times,format=""%H:%M:%S"")"
"0","pred_date<-as.POSIXct( date1 , format = ""%Y-%m-%d"")"
"0","st$date<-as.POSIXct(st$date,format=""%Y-%m-%d"")"
"0","st$time<-as.POSIXct(st$time,format=""%H:%M:%S"")"
"0","st_filtered<-st[st$date< pred_date ,]"
"0","d1<-distm(st_filtered[,c(""longitude"",""latitude"")], c(b,a),fun=distHaversine)"
"0","d2<-as.numeric(difftime(pred_date ,st_filtered$date,units = ""days""))"
"0","func <-function( time ,h){"
"0","  dist <- as.numeric(difftime(st_filtered$time,time , units=""hours""))"
"0","  dist [dist >12] <- 24 - dist [dist >12]"
"0","  exp(-(dist/h)^2)"
"0","}"
"0","k1<-exp(-(d1/h_distance)^2)"
"0","k2<-exp(-(d2/h_date)^2)"
"0","for(i in 1:length(timesf)){"
"0","  k3<-func(timesf[i],h_time)"
"0","  K<-as.vector(k1)+as.vector(k2)+as.vector(k3)"
"0","  temp[i]<-sum(K*st_filtered$air_temperature)/sum(K)"
"0","  "
"0","}"
"0","temp_mult<-vector(length=length(times))"
"0","for(i in 1:length(timesf)){"
"0","  k3<-func(timesf[i],h_time)"
"0","  K1<-as.vector(k1)*as.vector(k2)*as.vector(k3)"
"0","  temp_mult[i]<-sum(K1*st_filtered$air_temperature)/sum(K1)"
"0","  "
"0","}"
"0","plot(timesf,temp, type=""o"",col=""blue"",main=""Linkoping '2013-08-23' Sum kernel"",ylim=c(-5,7))"
