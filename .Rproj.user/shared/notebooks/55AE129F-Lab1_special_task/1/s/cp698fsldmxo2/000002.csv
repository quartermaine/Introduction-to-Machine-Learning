"0","spam<-readxl::read_excel(""spambase.xlsx"")"
"0","#spam$Spam<-as.factor(spam$Spam)"
"0","#levels(spam$Spam)<-c(""not spam"",""spam"")"
"0","spam<-as.data.frame(spam)"
"0","spam<-spam[sample(nrow(spam)),]"
"0","###split data"
"0","n=dim(spam)[1]"
"0","set.seed(12345)"
"0","id=sample(1:n, floor(n*0.5))"
"0","train=spam[id,]"
"0","test=spam[-id,]"
"0","train_X<-train[,!names(train)%in%c(""Spam"")]"
"0","train_labels<-train[,""Spam""]"
"0","test_X<-test[,!names(test)%in%c(""Spam"")]"
"0","test_labels<-test[,""Spam""]"
"0","#DD1<-cos_distance(train_X,train_X)"
"0","mis_error<-function(X,X1){"
"0","  n<-length(X)"
"0","  return(1-sum(diag(table(X,X1)))/n) #misclassification error function"
"0","}"
"0","##############################################################"
"0","K<-knearest(train_X, 30, train_X,train_labels)"
"0","mis1<-mis_error(as.vector(K),as.matrix(train_labels))  #0.2627737"
"0","K1<-knearest(train_X, 30, test_X,train_labels)"
"0","mis2<-mis_error(as.vector(K1),as.matrix(test_labels))  #0.3094891"
